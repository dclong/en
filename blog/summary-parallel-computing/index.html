<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Parallel Computing in Different Programming Languages</title>
  <meta name="author" content="Ben Chuanlong Du">

  <link href="http://www.legendu.net/en/atom.xml" type="application/atom+xml" rel="alternate"
        title="Ben Chuanlong Du's Blog Atom Feed" />


  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="http://www.legendu.net/en/favicon.png" rel="icon">
  <link href="http://www.legendu.net/en/theme/css/main_2.css" media="screen, projection"
        rel="stylesheet" type="text/css">
  <script src="http://www.legendu.net/en/theme/js/modernizr-2.0.js"></script>
  <script src="http://www.legendu.net/en/theme/js/ender.js"></script>
  <script src="http://www.legendu.net/en/theme/js/octopress.js" type="text/javascript"></script>

  <link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
  <link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
</head>

<body>
  <header role="banner"><hgroup>
  <h1><a href="http://www.legendu.net/en/">Ben Chuanlong Du's Blog</a></h1>
    <h2>And let it direct your passion with reason.</h2>
</hgroup></header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://www.legendu.net/en/atom.xml" rel="subscribe-rss">RSS</a></li>
</ul>

<form name="search" action="https://www.bing.com/search" method="get" onSubmit="return build_query()">
  <fieldset role="search">
      <!--
    <input type="hidden" name="q" value="site:http://www.legendu.net/en" />
        -->
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>

<script type = "text/javascript">
    function build_query() {
        var query = document.forms["search"]["q"].value;
        var prefix = "site:http://www.legendu.net/en "
        if (!query.startsWith(prefix)) {
            query = prefix + query;
            document.forms["search"]["q"].value = query;
        }
        return true;
    }
</script>

<ul class="main-navigation">
    <li><a href="http://www.legendu.net">Home</a></li>
    <li><a href="http://www.legendu.net/en">Blog</a></li>
    <li><a href="http://www.legendu.net/en/archives.html">Archives</a></li>
    <li><a href="http://www.legendu.net/pages/about">About</a></li>
</ul></nav>
  <div id="main">
    <div id="content">
<div>
  <article class="hentry" role="article">
<header>
      <h1 class="entry-title">Parallel Computing in Different Programming Languages</h1>
      <p class="meta"><time datetime="2019-04-28T11:50:22-07:00" pubdate>Apr 28, 2019</time></p>
</header>

  <div class="entry-content"><p>There many different ways for parallel computing. 
This article focus on multithreading computing.
Generally speaking, commercial softwares have very good support for parallel computing. 
For example, Mathematica, MATLAB and Revolution R all have solid support for parallel computing. 
Mathematica and MATLAB also have good support for GPU computing. </p>
<h2 id="python">Python</h2>
<p>Multithreading does not speed up computation in Python due to GIL. 
An alternative way use multiprocessing (using the <code>multiprocessing</code> library) in Python.
This is contrarary to most other programming languages which encourages multithreading rather than multiprocessing 
as processes are much heavier than thread and communication among processes are harder than communications among threads.
Despite this, <code>multiprocess.Pool.map</code> makes parallel computing real easy in Python.</p>
<h2 id="parallel-computing-in-bash"><a href="http://www.legendu.net/misc/blog/parallel-computing-in-bash/">Parallel Computing in Bash</a></h2>
<h2 id="mathematica">Mathematica</h2>
<p>In Mathematica,<br>
there are a bunch of functions starting with "Parallel" 
(e.g., <code>ParallelTable</code>, <code>ParallelSubmit</code>, etc) for the purpose of parallel computing. 
If I remember correctly, 
one has to distribute a user-defined function to kernels manually before you can use it for parallel computing in Mathmatica 7 and earlier. 
In Mathematica 8+, 
user-defined functions are automatically distributed to kernels 
so that you can use your own function for parallel computing directly, 
which is very convenient. 
Actually, 
Mathematica is the most convenient one to do parallel computing among all programming languages mentioned in this post, 
but at the cost of effciency of parallel computing. 
Mathematica is famous for its intellegency but also nutorious (at least I think so) for running slow. 
It is the most smart but also the slowest programming languages among all programming languages 
that I have ever used (not just these mentioned in this post). 
It is probably safe to say that Mathematica is the slowest programming language. 
The more convenient a language is, the slower it is generally speaking. 
It is hard to get both. 
A way to improve the speed of Mathematica code is 
to compile the code to C code or some other code that is more efficient to run. 
I will not go deeply into this since it is not the main purpose of this post.</p>
<h2 id="matlab">MATLAB</h2>
<p>There are several ways to do parallel computing in MATLAB. 
The one I know (and is probably the easiest way) is to use <code>parfor</code> instead of <code>for</code> in loops. 
If there is only 1 thread, 
<code>parfor</code> works in serial. 
To better use <code>parfor</code> for parallel computing, 
you have to learn some concept about different kinds of variables, 
e.g., slicing variables, reduced variables, etc.
Understanding these concept helps you write better parallel code, 
and it help debugging if your code does not work. 
To let <code>parfor</code> use multiple threads, 
you must open the matlabpool manually. 
For example, 
to use the local host for parallel computing, 
you use the following command to initilize a pool with 8 workers 
(I assume the computer has 8 cores). </p>
<div class="highlight"><pre><span></span><span class="n">matlabpool</span> <span class="n">open</span> <span class="n">local</span> <span class="mi">8</span>
</pre></div>


<p><code>parfor</code> in MATLAB works like a charm most of the time. 
Consider the fact that MATLAB code is very fast compared to other scripting languages, 
it is a good choice for heavy numeric computing.<br>
However, 
for some reason I am not sure about (probably bug in MATLAB interpreter), 
sometimes even very simple parallel code does not work. 
If this is happens, 
it is usually not easy to get if fixed. What you try is to change reduced variables to a slicing variable, 
and operate on the slicing variable after parallel computing. 
Another annoying thing I met when doing parallel computing in MATLAB was that 
sometimes the exactly same code did not work on another machine with the same version of MATLAB. 
I was not sure what caused the problem, 
but I found that it was related to functions end with <code>rnd</code> 
(random number generating functions) I used in the code. 
There are some old version functions starting with <code>rand</code> for generating random numbers, 
which are more robust and always works well in parallel computing.</p>
<h2 id="r">R</h2>
<p>R (not talking about Revolution R) has many packages for parallel computing.
Actually there are too many and thus make people confused about where to get started. 
Fortunately, the company of Revolution R contributed some packages to CRAN to make parallel computing in R unified. 
It is similar to <code>parfor</code> in MATLAB. 
You use <code>foreach</code> together with <code>%dopar%</code> to do parallel computing. 
To do this, 
you must first register a backend for it. 
The following simple example does parallel computing using package "doMC" as the backend of <code>foreach</code>.</p>
<div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">doMC</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">foreach</span><span class="p">)</span>
<span class="nf">registerDoMC</span><span class="p">(</span><span class="m">8</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="m">10000</span>
<span class="n">j</span><span class="o">=</span><span class="nf">foreach</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="n">n</span><span class="p">)</span> <span class="o">%dopar%</span> <span class="p">{</span>
    <span class="nf">for</span><span class="p">(</span><span class="n">j</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="m">10000</span><span class="p">){</span>
        <span class="m">1000</span> <span class="o">%%</span> <span class="m">31</span>
    <span class="p">}</span>
<span class="p">}</span>  
</pre></div>


<p>You can use package "snow" as the backend if you have access to a cluster.
In R, 
you do not have to worry about different kind of variables. 
Variables outside the <code>foreach</code> loop are shared among threads, 
and <code>foreach</code> returns a list of results corresponding to each iteration. 
Surely access variables outside the <code>foreach</code> loop
make the parallel compting less efficient. 
A better way is to let <code>foreach</code> return a list of results and then operate on the list. 
Sometimes, 
when you do parallel computing in R, 
the program does not speedup as you expect. 
This is probably because some functions you used has already been implemented in parallel. 
Notice that <code>foreach</code> is not just for parallel computing. 
Even if you do serial computing, you can still use <code>foreach</code> with <code>%dopar%</code> replaced by <code>%do%</code>. 
It is usually faster than the <code>for</code> loop.</p>
<h2 id="java-c">Java &amp; C++</h2>
<p>Both Java and C/C++ support multithreading directly. 
The concept of multithreading computing in these two languages are similar. 
You have to create multiple threads, 
and let each of them run part of the job.
Java has a better support for multithreading in the sense that its standard library supports thread pool. 
There is still no directly support of thread pool in C++11. 
You have to non-standard libraries for this purpose. 
For scientific computing (e.g. statistical simulations), 
it is usually every easy to partition the work by yourself 
and assign them to different threads so that a thread pool is not essential.
For example, 
if you want to do a simulation of 1000 runs, you can create <code>k</code> threads, 
assign the first <code>1000/k</code> runs to the first threads, 
assgin the second <code>1000/k</code> runs to the second threads, 
and so on and so forth.
To share data between different threads, 
usually you have to lock and unlock shared resources. 
In Java, 
this can be done through <code>ReentrantLock</code> class or <code>synchronized</code> methods.
In C/C++ this can be done through <code>mutex</code>. 
Details about multithreading computing in these two languages is beyond the scope of this post. 
For more information about multithreading in Java, 
you can refer to the book <code>Big Java</code> which is really easy to follow, 
and "C++ Concurrency in Action" is a good book about multithreading for C++. </p>
<p>Finally, 
I want to mention that not all computing job is suitable for parallel computing. 
The more comminication threads has to make, 
the more dependent the jobs are, the less efficient the parallel computing is. 
In statistical simulations, 
random numbers are usually generated in serial 
(though there are parallel algorithm for random number generating, the popular RNGs are usually serial). 
If a simulation is mostly about generating random numbers, 
it is probably non-benefitial to do parallel computing.</p></div>
    <footer>
<p class="meta">
  <span class="byline author vcard">
    Posted by <span class="fn">Ben Chuanlong Du</span>
  </span>
<time datetime="2019-04-28T11:50:22-07:00" pubdate>Apr 28, 2019</time>  <span class="categories">
    <a class="category" href="http://www.legendu.net/en/tag/mathematica.html">Mathematica</a>
    <a class="category" href="http://www.legendu.net/en/tag/lock.html">lock</a>
    <a class="category" href="http://www.legendu.net/en/tag/programming.html">programming</a>
    <a class="category" href="http://www.legendu.net/en/tag/cc.html">C/C++</a>
    <a class="category" href="http://www.legendu.net/en/tag/thread.html">thread</a>
    <a class="category" href="http://www.legendu.net/en/tag/java.html">Java</a>
    <a class="category" href="http://www.legendu.net/en/tag/hpc.html">HPC</a>
    <a class="category" href="http://www.legendu.net/en/tag/parallel.html">parallel</a>
    <a class="category" href="http://www.legendu.net/en/tag/r.html">R</a>
    <a class="category" href="http://www.legendu.net/en/tag/concurrency.html">concurrency</a>
    <a class="category" href="http://www.legendu.net/en/tag/mutex.html">mutex</a>
    <a class="category" href="http://www.legendu.net/en/tag/gpu-computing.html">GPU Computing</a>
  </span>
</p>    </footer>
  </article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
  </section>
</div>
<aside class="sidebar">
  <section>
    <h1>Recent Posts</h1>
    <ul id="recent_posts">
      <li class="post">
          <a href="http://www.legendu.net/en/blog/runtime-paths-in-python/">Runtime Paths in Python</a>
      </li>
      <li class="post">
          <a href="http://www.legendu.net/en/blog/configuration-scripts-for-the-blog-project-on-notebooks.ai/">Configuration Scripts for the Blog Project on Notebooks.Ai</a>
      </li>
      <li class="post">
          <a href="http://www.legendu.net/en/blog/string-in-python/">String in Python</a>
      </li>
      <li class="post">
          <a href="http://www.legendu.net/en/blog/my-docker-images/">My Docker Images</a>
      </li>
      <li class="post">
          <a href="http://www.legendu.net/en/blog/docker-image-and-container-management/">Manage Docker Images and Containers</a>
      </li>
    </ul>
  </section>
  <section>
      
    <h1>Categories</h1>
    <ul id="recent_posts">
        <li><a href="http://www.legendu.net/en/category/apple.html">Apple</a></li>
        <li><a href="http://www.legendu.net/en/category/fun-problems.html">Fun Problems</a></li>
        <li><a href="http://www.legendu.net/en/category/internet.html">internet</a></li>
        <li><a href="http://www.legendu.net/en/category/linux.html">Linux</a></li>
        <li><a href="http://www.legendu.net/en/category/network.html">Network</a></li>
        <li><a href="http://www.legendu.net/en/category/os.html">OS</a></li>
        <li><a href="http://www.legendu.net/en/category/programming.html">Programming</a></li>
        <li><a href="http://www.legendu.net/en/category/research.html">Research</a></li>
        <li><a href="http://www.legendu.net/en/category/software.html">Software</a></li>
        <li><a href="http://www.legendu.net/en/category/statistics.html">Statistics</a></li>
        <li><a href="http://www.legendu.net/en/category/work.html">Work</a></li>
    </ul>
  </section>
 

  <section>
  <h1>Tags</h1>
  <p class="tagcloud">
  </p>
  </section>



  <section>
    <h1>GitHub Repos</h1>
    <ul id="gh_repos">
      <li class="loading">Status updating...</li>
    </ul>
      <a href="https://github.com/dclong">@dclong</a> on GitHub
    <script type="text/javascript">
      $.domReady(function(){
          if (!window.jXHR){
              var jxhr = document.createElement('script');
              jxhr.type = 'text/javascript';
              jxhr.src = 'http://www.legendu.net/en/theme/js/jXHR.js';
              var s = document.getElementsByTagName('script')[0];
              s.parentNode.insertBefore(jxhr, s);
          }

          github.showRepos({
              user: 'dclong',
              count: 3,
              skip_forks: true,
              target: '#gh_repos'
          });
      });
    </script>
    <script src="http://www.legendu.net/en/theme/js/github.js" type="text/javascript"> </script>
  </section>

    <section>
        <h1>Social</h2>
        <ul>
            <li><a href="https://www.linkedin.com/in/ben-chuanlong-du-1239b221/" target="_blank">LinkedIn</a></li>
            <li><a href="https://twitter.com/longendu" target="_blank">Twitter</a></li>
            <li><a href="https://www.facebook.com/chuanlong.du" target="_blank">Facebook</a></li>
        <!--
            <li><a href="http://www.legendu.net/en/" type="application/rss+xml" rel="alternate">RSS</a></li>
            -->
        </ul>
    </section>
</aside>    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Ben Chuanlong Du -
  <span class="credit">Powered by <a href="http://getpelican.com">Pelican</a></span>
</p></footer>
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-30259661-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
	<script type="text/javascript">
	  var disqus_shortname = 'dclong';
          var disqus_identifier = '/blog/summary-parallel-computing/';
          var disqus_url = 'http://www.legendu.net/en/blog/summary-parallel-computing/';
          var disqus_title = 'Parallel Computing in Different Programming Languages';
	  (function() {
	    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
	    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	   })();
	</script>
</body>
</html>