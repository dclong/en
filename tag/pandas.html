<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Ben Chuanlong Du's Blog - pandas</title>
  <meta name="author" content="Ben Chuanlong Du">

  <link href="https://www.legendu.net/en/atom.xml" type="application/atom+xml" rel="alternate"
        title="Ben Chuanlong Du's Blog Atom Feed" />


  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="https://www.legendu.net/en/favicon.png" rel="icon">
  <link href="https://www.legendu.net/en/theme/css/main_2.css" media="screen, projection"
        rel="stylesheet" type="text/css">
  <script src="https://www.legendu.net/en/theme/js/modernizr-2.0.js"></script>
  <script src="https://www.legendu.net/en/theme/js/ender.js"></script>
  <script src="https://www.legendu.net/en/theme/js/octopress.js" type="text/javascript"></script>

  <link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
  <link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
  <script data-ad-client="ca-pub-3836424032203369" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
</head>

<body>
  <header role="banner"><hgroup>
  <h1><a href="https://www.legendu.net/en/">Ben Chuanlong Du's Blog</a></h1>
    <h2>And let it direct your passion with reason.</h2>
</hgroup></header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="https://www.legendu.net/en/atom.xml" rel="subscribe-rss">RSS</a></li>
</ul>

<form name="search" action="https://www.bing.com/search" method="get" onSubmit="return build_query()">
  <fieldset role="search">
      <!--
    <input type="hidden" name="q" value="site:https://www.legendu.net/en" />
        -->
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>

<script type = "text/javascript">
    function build_query() {
        var query = document.forms["search"]["q"].value;
        var prefix = "site:https://www.legendu.net/en "
        if (!query.startsWith(prefix)) {
            query = prefix + query;
            document.forms["search"]["q"].value = query;
        }
        return true;
    }
</script>

<ul class="main-navigation">
    <li><a href="https://www.legendu.net">Home</a></li>
    <li><a href="https://www.legendu.net/en">Blog</a></li>
    <li><a href="https://www.legendu.net/en/archives.html">Archives</a></li>
    <li><a href="https://www.legendu.net/pages/about">About</a></li>
</ul></nav>
  <div id="main">
    <div id="content">
<div class="blog-index">
  		<article>
<header>
      <h1 class="entry-title">
        <a href="https://www.legendu.net/en/blog/working-with-spreadsheet-with-python/">Working with Spreadsheet in Python</a>
      </h1>
      <p class="meta"><time datetime="2015-05-09T08:43:45-07:00" pubdate>May 09, 2015</time></p>
</header>

  <div class="entry-content"><p>It is suggested that you avoid using Excel files (or other spreadsheet tools) for storing data.
Parquet file is currently the best format for storing table-like data.
If you do want to interact and manipulate your data using Excel (or other spreadsheet tools),
dump your data into CSV files
and …</p></div>
  <footer>
    <a rel="full-article" href="https://www.legendu.net/en/blog/working-with-spreadsheet-with-python/">Read On &crarr;</a>
  </footer>
  		</article>
  		<article>
<header>
      <h1 class="entry-title">
        <a href="https://www.legendu.net/en/blog/pyspark-udf/">User-defined Function (UDF) in PySpark</a>
      </h1>
      <p class="meta"><time datetime="2020-11-27T22:55:16-08:00" pubdate>Nov 27, 2020</time></p>
</header>

  <div class="entry-content"><div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Tips-and-Traps">Tips and Traps<a class="anchor-link" href="#Tips-and-Traps">&#182;</a></h2><ol>
<li><p>The easist way to define a UDF in PySpark is to use the <code>@udf</code> tag,
 and similarly the easist way to define a Pandas UDF in PySpark is to use the <code>@pandas_udf</code> tag.
 Pandas UDFs are preferred to UDFs for server reasons.
 First, pandas UDFs are typically much faster than UDFs.
 Second, pandas UDFs are more flexible than UDFs on parameter passing.
 Both UDFs and pandas UDFs can take multiple columns as parameters.
 In addition, 
 pandas UDFs can take a DataFrame as parameter 
 (when passed to the <code>apply</code></div>
  <footer>
    <a rel="full-article" href="https://www.legendu.net/en/blog/pyspark-udf/">Read On &crarr;</a>
  </footer>
  		</article>
  		<article>
<header>
      <h1 class="entry-title">
        <a href="https://www.legendu.net/en/blog/compare-two-dataframes-using-datacompy/">Compare Data Frames Using DataCompy in Python</a>
      </h1>
      <p class="meta"><time datetime="2020-07-11T21:25:43-07:00" pubdate>Jul 11, 2020</time></p>
</header>

  <div class="entry-content"><div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Comments">Comments<a class="anchor-link" href="#Comments">&#182;</a></h2><ol>
<li><a href="https://github.com/datafold/data-diff">data-diff</a>
 is similar tool 
 which efficiently diff rows across two different databases.</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Installation">Installation<a class="anchor-link" href="#Installation">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input"></div>
  <footer>
    <a rel="full-article" href="https://www.legendu.net/en/blog/compare-two-dataframes-using-datacompy/">Read On &crarr;</a>
  </footer>
  		</article>
  		<article>
<header>
      <h1 class="entry-title">
        <a href="https://www.legendu.net/en/blog/python-pandas-rename/">Rename Rows and Columns in a pandas DataFrame</a>
      </h1>
      <p class="meta"><time datetime="2021-04-05T13:46:48-07:00" pubdate>Apr 05, 2021</time></p>
</header>

  <div class="entry-content"><div class="cell border-box-sizing code_cell rendered">
<div class="input"></div>
  <footer>
    <a rel="full-article" href="https://www.legendu.net/en/blog/python-pandas-rename/">Read On &crarr;</a>
  </footer>
  		</article>
  		<article>
<header>
      <h1 class="entry-title">
        <a href="https://www.legendu.net/en/blog/construct-pandas-dataframe-python/">Construct pandas DataFrames in Python</a>
      </h1>
      <p class="meta"><time datetime="2019-11-07T00:00:00-08:00" pubdate>Nov 07, 2019</time></p>
</header>

  <div class="entry-content"><div class="cell border-box-sizing code_cell rendered">
<div class="input"></div>
  <footer>
    <a rel="full-article" href="https://www.legendu.net/en/blog/construct-pandas-dataframe-python/">Read On &crarr;</a>
  </footer>
  		</article>
  		<article>
<header>
      <h1 class="entry-title">
        <a href="https://www.legendu.net/en/blog/select-columns-from-structured-text-files/">Select Columns from Structured Text Files</a>
      </h1>
      <p class="meta"><time datetime="2016-06-01T16:15:21-07:00" pubdate>Jun 01, 2016</time></p>
</header>

  <div class="entry-content"><h2 id="python-pandas">Python pandas</h2>
<p>My first choice is pandas in Python. 
However, 
below are some tools for quick and dirty solutions.</p>
<h2 id="q"><a href="https://github.com/harelba/q">q</a></h2>
<div class="highlight"><pre><span></span><code>q<span class="w"> </span>-t<span class="w"> </span>-H<span class="w"> </span><span class="s1">&#39;select c1, c3 from file.txt&#39;</span>
</code></pre></div>

<h2 id="cut">cut</h2>
<div class="highlight"><pre><span></span><code>cut<span class="w"> </span>-d<span class="se">\t</span><span class="w"> </span>-f1,3<span class="w"> </span>file.txt
</code></pre></div>

<h2 id="awk">awk</h2>
<div class="highlight"><pre><span></span><code>awk<span class="w"> </span>-F<span class="s1">&#39;\t&#39;</span><span class="w"> </span><span class="s1">&#39;{print $1 &quot;\t&quot; $3}&#39;</span><span class="w"> </span>file.tsv<span class="w"> </span>
</code></pre></div>

<p>Note: neither <code>cut …</code></p></div>
  <footer>
    <a rel="full-article" href="https://www.legendu.net/en/blog/select-columns-from-structured-text-files/">Read On &crarr;</a>
  </footer>
  		</article>
<div class="pagination">

  <br />
</div></div>
<aside class="sidebar">
  <section>
    <h1>Recent Posts</h1>
    <ul id="recent_posts">
      <li class="post">
          <a href="https://www.legendu.net/en/blog/working-with-spreadsheet-with-python/">Working with Spreadsheet in Python</a>
      </li>
      <li class="post">
          <a href="https://www.legendu.net/en/blog/pyspark-udf/">User-defined Function (UDF) in PySpark</a>
      </li>
      <li class="post">
          <a href="https://www.legendu.net/en/blog/compare-two-dataframes-using-datacompy/">Compare Data Frames Using DataCompy in Python</a>
      </li>
      <li class="post">
          <a href="https://www.legendu.net/en/blog/python-pandas-rename/">Rename Rows and Columns in a pandas DataFrame</a>
      </li>
      <li class="post">
          <a href="https://www.legendu.net/en/blog/construct-pandas-dataframe-python/">Construct pandas DataFrames in Python</a>
      </li>
    </ul>
  </section>
  <section>
    <h1>Categories</h1>
    <ul id="recent_posts">
        <li><a href="https://www.legendu.net/en/category/ai.html">AI</a></li>
        <li><a href="https://www.legendu.net/en/category/career.html">Career</a></li>
        <li><a href="https://www.legendu.net/en/category/computer-science.html">Computer Science</a></li>
        <li><a href="https://www.legendu.net/en/category/fun-problems.html">Fun Problems</a></li>
        <li><a href="https://www.legendu.net/en/category/internet.html">Internet</a></li>
        <li><a href="https://www.legendu.net/en/category/os.html">OS</a></li>
        <li><a href="https://www.legendu.net/en/category/research.html">Research</a></li>
        <li><a href="https://www.legendu.net/en/category/software.html">Software</a></li>
    </ul>
  </section>
 

  <section>
  <h1>Tags</h1>
  <ul class="tagcloud">
  </ul>
  </section>



  <section>
    <h1>GitHub Repos</h1>
    <ul id="gh_repos">
      <li class="loading">Status updating...</li>
    </ul>
      <a href="https://github.com/legendu-net">@legendu-net</a> on GitHub
    <script type="text/javascript">
      $.domReady(function(){
          if (!window.jXHR){
              var jxhr = document.createElement('script');
              jxhr.type = 'text/javascript';
              jxhr.src = 'https://www.legendu.net/en/theme/js/jXHR.js';
              var s = document.getElementsByTagName('script')[0];
              s.parentNode.insertBefore(jxhr, s);
          }

          github.showRepos({
              user: 'legendu-net',
              count: 5,
              skip_forks: true,
              target: '#gh_repos'
          });
      });
    </script>
    <script src="https://www.legendu.net/en/theme/js/github.js" type="text/javascript"> </script>
  </section>

    <section>
        <h1>Social</h2>
        <ul>
            <li><a href="https://www.linkedin.com/in/ben-chuanlong-du-1239b221/" target="_blank">LinkedIn</a></li>
            <li><a href="https://hub.docker.com/u/dclong" target="_blank">Docker Hub</a></li>
            <li><a href="https://stackoverflow.com/users/7808204/benjamin-du?tab=profile" target="_blank">Stack Overflow</a></li>
            <li><a href="https://twitter.com/longendu" target="_blank">Twitter</a></li>
        <!--
            <li><a href="https://www.legendu.net/en/" type="application/rss+xml" rel="alternate">RSS</a></li>
            -->
        </ul>
    </section>
</aside>    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Ben Chuanlong Du -
  <span class="credit">Powered by <a href="http://getpelican.com">Pelican</a></span>
</p></footer>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3STS9BVPF6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3STS9BVPF6');
</script>
	<script type="text/javascript">
	  var disqus_shortname = 'dclong';
	  (function() {
	    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
	    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	   })();
	</script>
</body>
</html>