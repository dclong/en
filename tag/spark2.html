<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Ben Chuanlong Du's Blog - Spark</title>
  <meta name="author" content="Ben Chuanlong Du">

  <link href="https://www.legendu.net/en/atom.xml" type="application/atom+xml" rel="alternate"
        title="Ben Chuanlong Du's Blog Atom Feed" />


  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="https://www.legendu.net/en/favicon.png" rel="icon">
  <link href="https://www.legendu.net/en/theme/css/main_2.css" media="screen, projection"
        rel="stylesheet" type="text/css">
  <script src="https://www.legendu.net/en/theme/js/modernizr-2.0.js"></script>
  <script src="https://www.legendu.net/en/theme/js/ender.js"></script>
  <script src="https://www.legendu.net/en/theme/js/octopress.js" type="text/javascript"></script>

  <link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
  <link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
  <script data-ad-client="ca-pub-3836424032203369" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
</head>

<body>
  <header role="banner"><hgroup>
  <h1><a href="https://www.legendu.net/en/">Ben Chuanlong Du's Blog</a></h1>
    <h2>And let it direct your passion with reason.</h2>
</hgroup></header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="https://www.legendu.net/en/atom.xml" rel="subscribe-rss">RSS</a></li>
</ul>

<form name="search" action="https://www.bing.com/search" method="get" onSubmit="return build_query()">
  <fieldset role="search">
      <!--
    <input type="hidden" name="q" value="site:https://www.legendu.net/en" />
        -->
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>

<script type = "text/javascript">
    function build_query() {
        var query = document.forms["search"]["q"].value;
        var prefix = "site:https://www.legendu.net/en "
        if (!query.startsWith(prefix)) {
            query = prefix + query;
            document.forms["search"]["q"].value = query;
        }
        return true;
    }
</script>

<ul class="main-navigation">
    <li><a href="https://www.legendu.net">Home</a></li>
    <li><a href="https://www.legendu.net/en">Blog</a></li>
    <li><a href="https://www.legendu.net/en/archives.html">Archives</a></li>
    <li><a href="https://www.legendu.net/pages/about">About</a></li>
</ul></nav>
  <div id="main">
    <div id="content">
<div class="blog-index">
  		<article>
<header>
      <h1 class="entry-title">
        <a href="https://www.legendu.net/en/blog/spark-issue:-RuntimeException:-unsupported-literal-type-class/">Spark Issue: RuntimeException: Unsupported Literal Type Class</a>
      </h1>
      <p class="meta"><time datetime="2022-01-15T14:36:45-08:00" pubdate>Jan 15, 2022</time></p>
</header>

  <div class="entry-content"><h2 id="symptom">Symptom</h2>
<blockquote>
<p>java.lang.RuntimeException: Unsupported literal type class java.util.ArrayList [1]</p>
</blockquote>
<h2 id="possible-causes">Possible Causes</h2>
<p>This happens in PySpark 
when a Python list is provide where a scalar is required.
Assuming <code>id0</code> is an integer column in the DataFrame <code>df</code>,
the following code throws the above error.</p>
<div class="highlight"><pre><span></span><code><span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3 …</span></code></pre></div></div>
  <footer>
    <a rel="full-article" href="https://www.legendu.net/en/blog/spark-issue:-RuntimeException:-unsupported-literal-type-class/">Read On &crarr;</a>
  </footer>
  		</article>
  		<article>
<header>
      <h1 class="entry-title">
        <a href="https://www.legendu.net/en/blog/pyspark-func-operators/">Column Functions and Operators in Spark</a>
      </h1>
      <p class="meta"><time datetime="2021-04-26T10:38:08-07:00" pubdate>Apr 26, 2021</time></p>
</header>

  <div class="entry-content"><div class="cell border-box-sizing code_cell rendered">
<div class="input"></div>
  <footer>
    <a rel="full-article" href="https://www.legendu.net/en/blog/pyspark-func-operators/">Read On &crarr;</a>
  </footer>
  		</article>
  		<article>
<header>
      <h1 class="entry-title">
        <a href="https://www.legendu.net/en/blog/pyspark-issue:-Java-gateway-process-exited-before-sending-the-driver-its-port-number/">PySpark Issue: Java Gateway Process Exited Before Sending the Driver Its Port Number</a>
      </h1>
      <p class="meta"><time datetime="2021-10-10T14:23:22-07:00" pubdate>Oct 10, 2021</time></p>
</header>

  <div class="entry-content"><p>I countered the issue when using PySpark locally
(the issue can happen to a cluster as well).
It turned out to be caused by a misconfiguration of the environment variable <code>JAVA_HOME</code> in Docker.</p>
<h2 id="references">References</h2>
<p><a href="https://stackoverflow.com/questions/31841509/pyspark-exception-java-gateway-process-exited-before-sending-the-driver-its-po">PySpark: Exception: Java gateway process exited before sending the driver its port number</a></p></div>
  <footer>
    <a rel="full-article" href="https://www.legendu.net/en/blog/pyspark-issue:-Java-gateway-process-exited-before-sending-the-driver-its-port-number/">Read On &crarr;</a>
  </footer>
  		</article>
  		<article>
<header>
      <h1 class="entry-title">
        <a href="https://www.legendu.net/en/blog/pyspark-func-date/">Date Functions in Spark</a>
      </h1>
      <p class="meta"><time datetime="2021-04-27T16:03:37-07:00" pubdate>Apr 27, 2021</time></p>
</header>

  <div class="entry-content"><div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Tips-and-Traps">Tips and Traps<a class="anchor-link" href="#Tips-and-Traps">&#182;</a></h2><ol>
<li>HDFS table might contain invalid data (I'm not clear about the reasons at this time) 
 with respct to the column types (e.g., Date and Timestamp). 
 This will cause issues when Spark tries to load the data.
 For more discussions,
 please refer to <a href="https://network.informatica.com/thread/85564">Unrecognized column type:TIMESTAMP_TYP</a>.</li>
</ol>
<ol>
<li><p><code>datetime.datetime</code> or <code>datetime.date</code></div>
  <footer>
    <a rel="full-article" href="https://www.legendu.net/en/blog/pyspark-func-date/">Read On &crarr;</a>
  </footer>
  		</article>
  		<article>
<header>
      <h1 class="entry-title">
        <a href="https://www.legendu.net/en/blog/compare-two-dataframes-using-datacompy/">Compare Data Frames Using DataCompy in Python</a>
      </h1>
      <p class="meta"><time datetime="2020-07-11T21:25:43-07:00" pubdate>Jul 11, 2020</time></p>
</header>

  <div class="entry-content"><div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Comments">Comments<a class="anchor-link" href="#Comments">&#182;</a></h2><ol>
<li><a href="https://github.com/datafold/data-diff">data-diff</a>
 is similar tool 
 which efficiently diff rows across two different databases.</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Installation">Installation<a class="anchor-link" href="#Installation">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input"></div>
  <footer>
    <a rel="full-article" href="https://www.legendu.net/en/blog/compare-two-dataframes-using-datacompy/">Read On &crarr;</a>
  </footer>
  		</article>
  		<article>
<header>
      <h1 class="entry-title">
        <a href="https://www.legendu.net/en/blog/packaging-python-dependencies-for-pyspark-using-conda-pack/">Packaging Python Dependencies for PySpark Using conda-pack</a>
      </h1>
      <p class="meta"><time datetime="2021-04-30T12:13:17-07:00" pubdate>Apr 30, 2021</time></p>
</header>

  <div class="entry-content"><p><a href="https://github.com/indygreg/python-build-standalone">python-build-standalone</a>
is a better alternative to conda-pack on managing Python dependencies for PySpark.
Please refer to 
<a href="http://www.legendu.net/en/blog/packaging-Python-Dependencies-for-PySpark-Using-python-build-standalone">Packaging Python Dependencies for PySpark Using python-build-standalone</a>
for tutorials on how to use
<a href="https://github.com/indygreg/python-build-standalone">python-build-standalone</a>
to manage Python dependencies for PySpark.</p>
<h2 id="build-portable-python-environments-using-conda-pack">Build Portable Python Environments Using conda-pack</h2>
<p>Please refer to the GitHub repo
<a href="https://github.com/dclong/conda_environ">dclong/conda_environ …</a></p></div>
  <footer>
    <a rel="full-article" href="https://www.legendu.net/en/blog/packaging-python-dependencies-for-pyspark-using-conda-pack/">Read On &crarr;</a>
  </footer>
  		</article>
<div class="pagination">
    <a class="prev" href="https://www.legendu.net/en/tag/spark3.html">&larr; Older</a>

      <a class="next" href="https://www.legendu.net/en/tag/spark.html">Newer &rarr;</a>
  <br />
</div></div>
<aside class="sidebar">
  <section>
    <h1>Recent Posts</h1>
    <ul id="recent_posts">
      <li class="post">
          <a href="https://www.legendu.net/en/blog/tips-on-pyspark/">Process Big Data Using PySpark</a>
      </li>
      <li class="post">
          <a href="https://www.legendu.net/en/blog/get-centos-version/">Get CentOS Version</a>
      </li>
      <li class="post">
          <a href="https://www.legendu.net/en/blog/control-number-of-partitions-of-a-dataframe-in-spark/">Control Number of Partitions of a DataFrame in Spark</a>
      </li>
      <li class="post">
          <a href="https://www.legendu.net/en/blog/spark-issue:-shell-related/">Spark Issue: Shell Related</a>
      </li>
      <li class="post">
          <a href="https://www.legendu.net/en/blog/spark-issue:-namespace-quota-is-exceeded/">Spark Issue: Namespace Quota Is Exceeded</a>
      </li>
    </ul>
  </section>
  <section>
    <h1>Categories</h1>
    <ul id="recent_posts">
        <li><a href="https://www.legendu.net/en/category/ai.html">AI</a></li>
        <li><a href="https://www.legendu.net/en/category/career.html">Career</a></li>
        <li><a href="https://www.legendu.net/en/category/computer-science.html">Computer Science</a></li>
        <li><a href="https://www.legendu.net/en/category/fun-problems.html">Fun Problems</a></li>
        <li><a href="https://www.legendu.net/en/category/internet.html">Internet</a></li>
        <li><a href="https://www.legendu.net/en/category/os.html">OS</a></li>
        <li><a href="https://www.legendu.net/en/category/research.html">Research</a></li>
        <li><a href="https://www.legendu.net/en/category/software.html">Software</a></li>
    </ul>
  </section>
 

  <section>
  <h1>Tags</h1>
  <ul class="tagcloud">
  </ul>
  </section>



  <section>
    <h1>GitHub Repos</h1>
    <ul id="gh_repos">
      <li class="loading">Status updating...</li>
    </ul>
      <a href="https://github.com/legendu-net">@legendu-net</a> on GitHub
    <script type="text/javascript">
      $.domReady(function(){
          if (!window.jXHR){
              var jxhr = document.createElement('script');
              jxhr.type = 'text/javascript';
              jxhr.src = 'https://www.legendu.net/en/theme/js/jXHR.js';
              var s = document.getElementsByTagName('script')[0];
              s.parentNode.insertBefore(jxhr, s);
          }

          github.showRepos({
              user: 'legendu-net',
              count: 5,
              skip_forks: true,
              target: '#gh_repos'
          });
      });
    </script>
    <script src="https://www.legendu.net/en/theme/js/github.js" type="text/javascript"> </script>
  </section>

    <section>
        <h1>Social</h2>
        <ul>
            <li><a href="https://www.linkedin.com/in/ben-chuanlong-du-1239b221/" target="_blank">LinkedIn</a></li>
            <li><a href="https://hub.docker.com/u/dclong" target="_blank">Docker Hub</a></li>
            <li><a href="https://stackoverflow.com/users/7808204/benjamin-du?tab=profile" target="_blank">Stack Overflow</a></li>
            <li><a href="https://twitter.com/longendu" target="_blank">Twitter</a></li>
        <!--
            <li><a href="https://www.legendu.net/en/" type="application/rss+xml" rel="alternate">RSS</a></li>
            -->
        </ul>
    </section>
</aside>    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Ben Chuanlong Du -
  <span class="credit">Powered by <a href="http://getpelican.com">Pelican</a></span>
</p></footer>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3STS9BVPF6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3STS9BVPF6');
</script>
	<script type="text/javascript">
	  var disqus_shortname = 'dclong';
	  (function() {
	    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
	    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	   })();
	</script>
</body>
</html>