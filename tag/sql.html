<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Ben Chuanlong Du's Blog - SQL</title>
  <meta name="author" content="Ben Chuanlong Du">

  <link href="https://www.legendu.net/en/atom.xml" type="application/atom+xml" rel="alternate"
        title="Ben Chuanlong Du's Blog Atom Feed" />


  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="https://www.legendu.net/en/favicon.png" rel="icon">
  <link href="https://www.legendu.net/en/theme/css/main_2.css" media="screen, projection"
        rel="stylesheet" type="text/css">
  <script src="https://www.legendu.net/en/theme/js/modernizr-2.0.js"></script>
  <script src="https://www.legendu.net/en/theme/js/ender.js"></script>
  <script src="https://www.legendu.net/en/theme/js/octopress.js" type="text/javascript"></script>

  <link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
  <link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
  <script data-ad-client="ca-pub-3836424032203369" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
</head>

<body>
  <header role="banner"><hgroup>
  <h1><a href="https://www.legendu.net/en/">Ben Chuanlong Du's Blog</a></h1>
    <h2>And let it direct your passion with reason.</h2>
</hgroup></header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="https://www.legendu.net/en/atom.xml" rel="subscribe-rss">RSS</a></li>
</ul>

<form name="search" action="https://www.bing.com/search" method="get" onSubmit="return build_query()">
  <fieldset role="search">
      <!--
    <input type="hidden" name="q" value="site:https://www.legendu.net/en" />
        -->
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>

<script type = "text/javascript">
    function build_query() {
        var query = document.forms["search"]["q"].value;
        var prefix = "site:https://www.legendu.net/en "
        if (!query.startsWith(prefix)) {
            query = prefix + query;
            document.forms["search"]["q"].value = query;
        }
        return true;
    }
</script>

<ul class="main-navigation">
    <li><a href="https://www.legendu.net">Home</a></li>
    <li><a href="https://www.legendu.net/en">Blog</a></li>
    <li><a href="https://www.legendu.net/en/archives.html">Archives</a></li>
    <li><a href="https://www.legendu.net/pages/about">About</a></li>
</ul></nav>
  <div id="main">
    <div id="content">
<div class="blog-index">
  		<article>
<header>
      <h1 class="entry-title">
        <a href="https://www.legendu.net/en/blog/pyspark-func-date/">Date Functions in Spark</a>
      </h1>
      <p class="meta"><time datetime="2021-04-27T16:03:37-07:00" pubdate>Apr 27, 2021</time></p>
</header>

  <div class="entry-content"><div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Tips-and-Traps">Tips and Traps<a class="anchor-link" href="#Tips-and-Traps">&#182;</a></h2><ol>
<li>HDFS table might contain invalid data (I'm not clear about the reasons at this time) 
 with respct to the column types (e.g., Date and Timestamp). 
 This will cause issues when Spark tries to load the data.
 For more discussions,
 please refer to <a href="https://network.informatica.com/thread/85564">Unrecognized column type:TIMESTAMP_TYP</a>.</li>
</ol>
<ol>
<li><p><code>datetime.datetime</code> or <code>datetime.date</code></div>
  <footer>
    <a rel="full-article" href="https://www.legendu.net/en/blog/pyspark-func-date/">Read On &crarr;</a>
  </footer>
  		</article>
  		<article>
<header>
      <h1 class="entry-title">
        <a href="https://www.legendu.net/en/blog/understand-execuation-of-sql-statements/">Understand Execuation of SQL Statements</a>
      </h1>
      <p class="meta"><time datetime="2021-08-17T08:37:00-07:00" pubdate>Aug 17, 2021</time></p>
</header>

  <div class="entry-content"><div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Execuation-Order">Execuation Order<a class="anchor-link" href="#Execuation-Order">&#182;</a></h2><p>A SQL statement selects rows and columns from a big (rectangular) table. 
You put columns that you want to select after <code>SELECT</code> 
and rows you want to select after <code>FROM</code>.
A SQL statement is executed as follows.
First, 
the (INNER|LEFT|RIGHT|FULL) <code>JOIN (ON)</code> is executed if any (see more explanation later).
Second, 
the <code>WHERE</code></div>
  <footer>
    <a rel="full-article" href="https://www.legendu.net/en/blog/understand-execuation-of-sql-statements/">Read On &crarr;</a>
  </footer>
  		</article>
  		<article>
<header>
      <h1 class="entry-title">
        <a href="https://www.legendu.net/en/blog/select-columns-from-structured-text-files/">Select Columns from Structured Text Files</a>
      </h1>
      <p class="meta"><time datetime="2016-06-01T16:15:21-07:00" pubdate>Jun 01, 2016</time></p>
</header>

  <div class="entry-content"><h2 id="python-pandas">Python pandas</h2>
<p>My first choice is pandas in Python. 
However, 
below are some tools for quick and dirty solutions.</p>
<h2 id="q"><a href="https://github.com/harelba/q">q</a></h2>
<div class="highlight"><pre><span></span><code>q<span class="w"> </span>-t<span class="w"> </span>-H<span class="w"> </span><span class="s1">&#39;select c1, c3 from file.txt&#39;</span>
</code></pre></div>

<h2 id="cut">cut</h2>
<div class="highlight"><pre><span></span><code>cut<span class="w"> </span>-d<span class="se">\t</span><span class="w"> </span>-f1,3<span class="w"> </span>file.txt
</code></pre></div>

<h2 id="awk">awk</h2>
<div class="highlight"><pre><span></span><code>awk<span class="w"> </span>-F<span class="s1">&#39;\t&#39;</span><span class="w"> </span><span class="s1">&#39;{print $1 &quot;\t&quot; $3}&#39;</span><span class="w"> </span>file.tsv<span class="w"> </span>
</code></pre></div>

<p>Note: neither <code>cut …</code></p></div>
  <footer>
    <a rel="full-article" href="https://www.legendu.net/en/blog/select-columns-from-structured-text-files/">Read On &crarr;</a>
  </footer>
  		</article>
  		<article>
<header>
      <h1 class="entry-title">
        <a href="https://www.legendu.net/en/blog/sample-lines-from-a-file-using-command-line/">Sample Lines from a File Using Command Line</a>
      </h1>
      <p class="meta"><time datetime="2016-06-28T10:52:36-07:00" pubdate>Jun 28, 2016</time></p>
</header>

  <div class="entry-content"><p>NOTE: the article talks about sampling "lines" rather than "records". 
If a records can occupy multiple lines, 
e.g., if any field contains a new line (<code>\n</code>),
the following tutorial does not work 
and you have to fall back to more powerful tools such as Python or R.</p>
<p>Let's say …</p></div>
  <footer>
    <a rel="full-article" href="https://www.legendu.net/en/blog/sample-lines-from-a-file-using-command-line/">Read On &crarr;</a>
  </footer>
  		</article>
<div class="pagination">

  <br />
</div></div>
<aside class="sidebar">
  <section>
    <h1>Recent Posts</h1>
    <ul id="recent_posts">
      <li class="post">
          <a href="https://www.legendu.net/en/blog/pyspark-func-date/">Date Functions in Spark</a>
      </li>
      <li class="post">
          <a href="https://www.legendu.net/en/blog/understand-execuation-of-sql-statements/">Understand Execuation of SQL Statements</a>
      </li>
      <li class="post">
          <a href="https://www.legendu.net/en/blog/select-columns-from-structured-text-files/">Select Columns from Structured Text Files</a>
      </li>
      <li class="post">
          <a href="https://www.legendu.net/en/blog/sample-lines-from-a-file-using-command-line/">Sample Lines from a File Using Command Line</a>
      </li>
    </ul>
  </section>
  <section>
    <h1>Categories</h1>
    <ul id="recent_posts">
        <li><a href="https://www.legendu.net/en/category/ai.html">AI</a></li>
        <li><a href="https://www.legendu.net/en/category/career.html">Career</a></li>
        <li><a href="https://www.legendu.net/en/category/computer-science.html">Computer Science</a></li>
        <li><a href="https://www.legendu.net/en/category/fun-problems.html">Fun Problems</a></li>
        <li><a href="https://www.legendu.net/en/category/internet.html">Internet</a></li>
        <li><a href="https://www.legendu.net/en/category/os.html">OS</a></li>
        <li><a href="https://www.legendu.net/en/category/research.html">Research</a></li>
        <li><a href="https://www.legendu.net/en/category/software.html">Software</a></li>
    </ul>
  </section>
 

  <section>
  <h1>Tags</h1>
  <ul class="tagcloud">
  </ul>
  </section>



  <section>
    <h1>GitHub Repos</h1>
    <ul id="gh_repos">
      <li class="loading">Status updating...</li>
    </ul>
      <a href="https://github.com/legendu-net">@legendu-net</a> on GitHub
    <script type="text/javascript">
      $.domReady(function(){
          if (!window.jXHR){
              var jxhr = document.createElement('script');
              jxhr.type = 'text/javascript';
              jxhr.src = 'https://www.legendu.net/en/theme/js/jXHR.js';
              var s = document.getElementsByTagName('script')[0];
              s.parentNode.insertBefore(jxhr, s);
          }

          github.showRepos({
              user: 'legendu-net',
              count: 5,
              skip_forks: true,
              target: '#gh_repos'
          });
      });
    </script>
    <script src="https://www.legendu.net/en/theme/js/github.js" type="text/javascript"> </script>
  </section>

    <section>
        <h1>Social</h2>
        <ul>
            <li><a href="https://www.linkedin.com/in/ben-chuanlong-du-1239b221/" target="_blank">LinkedIn</a></li>
            <li><a href="https://hub.docker.com/u/dclong" target="_blank">Docker Hub</a></li>
            <li><a href="https://stackoverflow.com/users/7808204/benjamin-du?tab=profile" target="_blank">Stack Overflow</a></li>
            <li><a href="https://twitter.com/longendu" target="_blank">Twitter</a></li>
        <!--
            <li><a href="https://www.legendu.net/en/" type="application/rss+xml" rel="alternate">RSS</a></li>
            -->
        </ul>
    </section>
</aside>    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Ben Chuanlong Du -
  <span class="credit">Powered by <a href="http://getpelican.com">Pelican</a></span>
</p></footer>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3STS9BVPF6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3STS9BVPF6');
</script>
	<script type="text/javascript">
	  var disqus_shortname = 'dclong';
	  (function() {
	    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
	    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	   })();
	</script>
</body>
</html>